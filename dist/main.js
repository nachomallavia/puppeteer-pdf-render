(()=>{var __webpack_modules__={920:module=>{module.exports={ifEquals:function(e,o,a){return e===o?a.fn(this):a.inverse(this)},groupBy:function(e,o,a){let t=[],i=[];if(null!=e)for(let a=0;a<e.length;a++){let r=e[a][o],n="";if(0!=a&&(n=e[a-1][o]),r!=n&&-1===i.indexOf(r)){i.push(r);let a=e.filter((e=>e[o]==r));t.push(a)}}return t.forEach((e=>e.sort(((e,o)=>new Date(o.FechaVto)-new Date(e.FechaVto))))),t},formatDate:function(e){if(""==e||null==e)return"";let o=new Date(e);return new Intl.DateTimeFormat("es-AR").format(o)},compare:function(variableOne,comparator,variableTwo){return!!eval(variableOne+comparator+variableTwo)},minus:function(e){return-1*e},today:function(){let e=Date.now();return new Intl.DateTimeFormat("es-AR").format(e)},sumarSaldos:function(e){let o=0;return null!=e&&null!=e[0]&&(o=e[0].SaldoCSTitular+e[0].SaldoCSAdherente+e[0].SaldoServicios+e[0].SaldoCreditos,e[0].ImporteSinAplicar&&(o-=e[0].ImporteSinAplicar)),o},format:function(e){let o,a=new Intl.NumberFormat("es-AR",{style:"decimal",maximumFractionDigits:0,minimumFractionDigits:0}),t=new Intl.NumberFormat("es-AR",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2});return o=e%1==0?a.format(e):t.format(e),o.split(" ").join("")},renderMin:function(e,o){return e<o?e:o}}},445:(e,o,a)=>{const t=a(758);a(818).config(),e.exports={pdfLogic:async e=>{const o=await t.launch({args:["--disable-setuid-sandbox","--no-sandbox","--single-process","--no-zygote"],executablePath:process.env.PUPPETEER_EXECUTABLE_PATH});try{console.log("trying to make a PDF");const a=await o.newPage(),t=e.body.html;await a.setContent(t,{waitUntil:"networkidle0"}),await a.setViewport({width:1440,height:1880}),await a.emulateMediaType("screen");const i=await a.pdf({format:"A4",printBackground:!0});return await o.close(),i}catch(e){console.error(e)}finally{await o.close()}}}},279:(module,__unused_webpack_exports,__webpack_require__)=>{const{readFile,readFileSync}=__webpack_require__(383),path=__webpack_require__(3);module.exports=async function(templateName,dataObject){const Handlebars=__webpack_require__(156);let templatePath=path.join(__dirname,"templates",templateName)+".hbs";const content=readFileSync(templatePath,{encodig:"utf8"});Handlebars.registerHelper("sumarSaldos",(e=>{let o=0;return null!=e&&null!=e[0]&&(o=e[0].SaldoCSTitular+e[0].SaldoCSAdherente+e[0].SaldoServicios+e[0].SaldoCreditos,e[0].ImporteSinAplicar&&(o-=e[0].ImporteSinAplicar)),o})),Handlebars.registerHelper("renderMin",(function(e,o){return e<o?e:o})),Handlebars.registerHelper("format",(function(e){let o,a=new Intl.NumberFormat("es-AR",{style:"decimal",maximumFractionDigits:0,minimumFractionDigits:0}),t=new Intl.NumberFormat("es-AR",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2});return o=e%1==0?a.format(e):t.format(e),o.split(" ").join("")})),Handlebars.registerHelper("formatDate",(e=>{if(""==e||null==e)return"";let o=new Date(e);return new Intl.DateTimeFormat("es-AR").format(o)})),Handlebars.registerHelper("groupBy",(function(e,o,a){let t=[],i=[];if(null!=e)for(let a=0;a<e.length;a++){let r=e[a][o],n="";if(0!=a&&(n=e[a-1][o]),r!=n&&-1===i.indexOf(r)){i.push(r);let a=e.filter((e=>e[o]==r));t.push(a)}}return t.forEach((e=>e.sort(((e,o)=>new Date(o.FechaVto)-new Date(e.FechaVto))))),t})),Handlebars.registerHelper("ifEquals",(function(e,o,a){return e===o?a.fn(this):a.inverse(this)})),Handlebars.registerHelper("compare",(function(variableOne,comparator,variableTwo){return!!eval(variableOne+comparator+variableTwo)})),Handlebars.registerHelper("minus",(function(e){return-1*e})),Handlebars.registerHelper("today",(function(){let e=Date.now();return new Intl.DateTimeFormat("es-AR").format(e)}));const template=Handlebars.compile(`${content}`),html=template(dataObject);return html}},268:e=>{"use strict";e.exports=require("body-parser")},818:e=>{"use strict";e.exports=require("dotenv")},252:e=>{"use strict";e.exports=require("express")},707:e=>{"use strict";e.exports=require("express-handlebars")},383:e=>{"use strict";e.exports=require("fs")},156:e=>{"use strict";e.exports=require("handlebars")},3:e=>{"use strict";e.exports=require("path")},758:e=>{"use strict";e.exports=require("puppeteer")},712:e=>{"use strict";e.exports=JSON.parse('{"socio":{"socio":{"Id_Cliente":80224052,"Nombre":"BELLO, PATRICIA CRISTINA","NroDoc":18565258,"Fecha_Alta":"2024-05-21T00:00:00","Id_Asociado":14046143,"Fecha_Nacimiento":"1966-11-28T00:00:00","Telefono":"351-3485533","Celular":"351-3485533","Mail":"patriciabello600@gmail.com","TipoDoc":"DNI","Fecha_Asociado":"2024-05-21T00:00:00","Fecha_Baja":null,"Direccion":"ENTRE RIOS","Domicilio_Nro":"1667","Domicilio_Piso":"","Domicilio_Dpto":"  ","Localidad":"SAN VICENTE (CORDOBA-DPTO. CAPITAL)","Provincia":"Córdoba","Codpos":"5000","Id_Plan":4,"Plan_Socio":"Platino","Id_Comercializador":2059968,"Comercializador":"Fernandez Alberione, Romina Ana","Id_Filial":14,"Filial":"Administración Comercializadores","Usuario_Baja":"","Ultimo_Vto_Repositorio":"2025-01-28T00:00:00","Digito_Verificador":"2"}},"servicios":[{"Nombre":"BELLO, PATRICIA CRISTINA","NroDoc":18565258,"Importe":10390,"Fecha_Alta":"2024-05-21T00:00:00","Parentesco":"Titular","Fecha_Fin":null,"MC":"CAJA JUB. PENS. Y RET. DE CORDOBA","Comercializador":"Fernandez Alberione, Romina Ana","Id_Comer":2059968,"Importe_CS_Base":10390,"Ultima_Fecha_Cobro":"2024-11-12T00:00:00"}],"otrosServicios":[{"Servicio":"Adicional Plan Cuota Social","Importe":23600,"Fecha_Alta":"2024-06-14T00:00:00","Fecha_Fin":null,"MC":"CBU","Ultima_Fecha_Cobro":"2024-06-28T00:00:00"}],"creditosNoAdministrados":[{"Id_Credito":0,"Id_Solicitud":887289,"Fecha_Prestamo":"2024-05-21T00:00:00","Linea":"MAITEN Caja de Cordoba - Tercero","Capital":215000,"Plazo":24,"ValorCuota":40320,"Cuotas_Pagadas":0,"Cuotas_Impagas":0,"Cuotas_A_Devengar":17,"Id_Comercializador":2059968,"Comercializador":"Fernandez Alberione, Romina Ana","Medio_Cobro_Prestamo":"","Estado":"Aceptado","Proveedor_Financiero":"MAITEN COOP.DE CRED, CONSUMO Y VIV LTDA"}],"creditosAdministrados":[],"saldoCtaCte":-82500,"motivosClientes":[{"TipoSocio":"Titular","TipoMovimiento":"Alta","Fecha":"2024-05-21T00:00:00","Motivo":"Gestión de Préstamo Amtae","Usuario":"Romina Ana Fernandez Alberione"}],"serviciosRepositorio":[{"TipoServicio":"Cuota Social","FechaVto":"2024-07-28T00:00:00","Importe":7690,"CobImporte":7690,"Saldo":0,"TipoCS":"Titular","Adherente":"","FechaCobro":"2024-07-10T00:00:00","Mes_Servicio":"05-2024","FechaMod":null},{"TipoServicio":"Cuota Social","FechaVto":"2024-08-28T00:00:00","Importe":7690,"CobImporte":7690,"Saldo":0,"TipoCS":"Titular","Adherente":"","FechaCobro":"2024-08-07T00:00:00","Mes_Servicio":"06-2024","FechaMod":null},{"TipoServicio":"Adicional Plan Cuota Social","FechaVto":"2024-07-28T17:35:59.42","Importe":17300,"CobImporte":17300,"Saldo":0,"TipoCS":" ","Adherente":"","FechaCobro":"2024-06-28T00:00:00","Mes_Servicio":"06-2024","FechaMod":null},{"TipoServicio":"Cuota Social","FechaVto":"2024-09-28T00:00:00","Importe":9190,"CobImporte":9190,"Saldo":0,"TipoCS":"Titular","Adherente":"","FechaCobro":"2024-09-09T00:00:00","Mes_Servicio":"07-2024","FechaMod":null},{"TipoServicio":"Adicional Plan Cuota Social","FechaVto":"2024-08-28T00:00:00","Importe":17300,"CobImporte":0,"Saldo":17300,"TipoCS":" ","Adherente":"","FechaCobro":null,"Mes_Servicio":"07-2024","FechaMod":null},{"TipoServicio":"Cuota Social","FechaVto":"2024-10-28T00:00:00","Importe":9190,"CobImporte":9190,"Saldo":0,"TipoCS":"Titular","Adherente":"","FechaCobro":"2024-10-10T00:00:00","Mes_Servicio":"08-2024","FechaMod":null},{"TipoServicio":"Adicional Plan Cuota Social","FechaVto":"2024-09-28T00:00:00","Importe":20800,"CobImporte":0,"Saldo":20800,"TipoCS":" ","Adherente":"","FechaCobro":null,"Mes_Servicio":"08-2024","FechaMod":null},{"TipoServicio":"Cuota Social","FechaVto":"2024-11-28T00:00:00","Importe":10390,"CobImporte":10390,"Saldo":0,"TipoCS":"Titular","Adherente":"","FechaCobro":"2024-11-12T00:00:00","Mes_Servicio":"09-2024","FechaMod":null},{"TipoServicio":"Adicional Plan Cuota Social","FechaVto":"2024-10-28T00:00:00","Importe":20800,"CobImporte":0,"Saldo":20800,"TipoCS":" ","Adherente":"","FechaCobro":null,"Mes_Servicio":"09-2024","FechaMod":null},{"TipoServicio":"Cuota Social","FechaVto":"2024-12-28T00:00:00","Importe":10390,"CobImporte":0,"Saldo":10390,"TipoCS":"Titular","Adherente":"","FechaCobro":null,"Mes_Servicio":"10-2024","FechaMod":null},{"TipoServicio":"Adicional Plan Cuota Social","FechaVto":"2024-11-28T00:00:00","Importe":23600,"CobImporte":0,"Saldo":23600,"TipoCS":" ","Adherente":"","FechaCobro":null,"Mes_Servicio":"10-2024","FechaMod":null},{"TipoServicio":"Cuota Social","FechaVto":"2025-01-28T00:00:00","Importe":10390,"CobImporte":0,"Saldo":10390,"TipoCS":"Titular","Adherente":"","FechaCobro":null,"Mes_Servicio":"11-2024","FechaMod":null},{"TipoServicio":"Adicional Plan Cuota Social","FechaVto":"2024-12-28T00:00:00","Importe":23600,"CobImporte":0,"Saldo":23600,"TipoCS":" ","Adherente":"","FechaCobro":null,"Mes_Servicio":"11-2024","FechaMod":null}],"saldosTotales":[{"Id":80224052,"SaldoCSTitular":0,"SaldoCSAdherente":0,"SaldoServicios":82500,"SaldoCreditos":0,"ImporteSinAplicar":0}],"saldosAVencer":[],"cuotasSociales":[{"ApellidoYNombre":"Test Adherente","NroDoc":11111111,"Parentesco":"Hijo","Fecha_Alta":"2024-06-14T00:00:00","Importe":2500,"Fecha_Baja":"","MC":"Rapipago"}]}')}},__webpack_module_cache__={};function __webpack_require__(e){var o=__webpack_module_cache__[e];if(void 0!==o)return o.exports;var a=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](a,a.exports,__webpack_require__),a.exports}const express=__webpack_require__(252);__webpack_require__(818).config();const app=express(),exphbs=__webpack_require__(707),hbs=exphbs.create({helpers:__webpack_require__(920),extname:".hbs",defaultLayout:!1}),path=__webpack_require__(3),{pdfLogic}=__webpack_require__(445),renderLogic=__webpack_require__(279),token=process.env.API_TOKEN,bodyParser=__webpack_require__(268),mockData=__webpack_require__(712),PORT=process.env.PORT||4e3;app.engine(".hbs",hbs.engine),app.engine(".html",hbs.engine),app.use(express.json()),app.set("view engine","hbs"),app.set("views",path.join(__dirname,"templates")),app.use(express.urlencoded({extended:!0})),app.use(express.static(path.join(__dirname,"public"))),app.post("/pdf",(async(e,o)=>{const a=e.body.template,t=await renderLogic(a,mockData);e.body.html=t;const i=await pdfLogic(e);o.set("content-type","application/pdf"),o.send(i)})),app.get("/",((e,o)=>{o.sendFile(path.join(__dirname,"index.html"))})),app.get("/:id",(async(e,o)=>{const a=e.params.id,t=await fetch(`https://sistema.mundoamtae.com/alianzas/Api/SalesForce/GetReporteEstadoCuenta/${token}/${a}`);if(200==t.status){const e=await t.json();o.render("estado-de-cuenta",e)}else 400==t.status&&console.log(t)})),app.get("/:id/pdf/",(async(e,o)=>{const a=e.params.id,t=await fetch(`https://sistema.mundoamtae.com/alianzas/Api/SalesForce/GetReporteEstadoCuenta/${token}/${a}`);if(200==t.status){const a="estado-de-cuenta",i=await t.json(),r=await renderLogic(a,i);e.body.html=r;const n=await pdfLogic(e);o.set("content-type","application/pdf"),o.send(n)}else 400==t.status&&console.log(t)})),app.get("/:id/ampliar",(async(e,o)=>{const a=e.params.id,t=await fetch(`https://sistema.mundoamtae.com/alianzas/Api/SalesForce/GetReporteEstadoCuenta/${token}/${a}`);if(200==t.status){const e=await t.json();o.render("estado-de-cuenta-ampliado",e)}else 400==t.status&&console.log(t)})),app.get("/:id/ampliar/pdf/",(async(e,o)=>{const a=e.params.id,t=await fetch(`https://sistema.mundoamtae.com/alianzas/Api/SalesForce/GetReporteEstadoCuenta/${token}/${a}`);if(200==t.status){const a="estado-de-cuenta-ampliado",i=await t.json(),r=await renderLogic(a,i);e.body.html=r;const n=await pdfLogic(e);o.set("content-type","application/pdf"),o.send(n)}else 400==t.status&&console.log(t)})),app.listen(PORT,(()=>{console.log(`Listening on port ${PORT}`)}))})();
//# sourceMappingURL=main.js.map